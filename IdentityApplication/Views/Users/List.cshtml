@model IdentityApplication.Models.ViewModels.UsersViewModel
@{
    ViewData["Title"] = "Users";
}

<div class="text-center">
    <h1 class="display-4">Users</h1>
    <p>You can manage users from this screen.</p>
</div>

<div class="row">
    <div class="col-12">
        &nbsp;
    </div>
</div>


<table class="table table-striped table-bordered">
    <thead>
        <tr>
            <td>Name</td>
            <td>Email</td>
            <td>Admin</td>
        </tr>
    </thead>
    <tbody>
        @foreach (var user in Model.Users)
        {
            <tr>
                <td>@user.UserName</td>
                <td>@user.Email</td>
                <td>
                    @{
                        var url = Url.Action("MakeAsAdmin", "Users", new { isAdmin = user.IsAdmin, userName = user.UserName, currentPage = Model.CurrentPage, maxRows = Model.MaxRows }, null);
                    }

                    <div class="form-check form-switch">
                        <input type="checkbox" asp-controller="Users" asp-action="MakeAsAdmin" 
                               asp-isAdmin="@user.IsAdmin" asp-userName="@user.UserName" 
                               asp-currentPage="@Model.CurrentPage" asp-maxRows="@Model.MaxRows"
                               class="form-check-input" id="flexSwitchCheckDefault"/>
                        @*@Html.CheckBoxFor(m => user.IsAdmin, new { @class = "form-check-input", @id = "flexSwitchCheckDefault", onclick = "window.location = '" + url + "'" })*@
                        <label class="form-check-label" for="flexSwitchCheckDefault"></label>
                    </div>
                </td>
            </tr>

        }
    </tbody>
</table>

<br />
<form asp-action="List" asp-controller="Users">

    <nav aria-label="Page navigation example">
        <ul class="pagination justify-content-center">
            @for (int i = 1; i <= Model.PageCount; i++)
            {
                @if (i != Model.CurrentPage)
                {
                    <li class="page-item">
                        <input class="btn btn-primary" type="submit" value="@i" onclick="javascript:PagerClick(@i);" />
                    </li>
                }
                else
                {
                    <li class="page-item">
                        <input class="btn btn-primary" type="submit" value="@i" onclick="javascript:PagerClick(@i);" disabled />
                    </li>
                }
            }
        </ul>
    </nav>


    <input type="hidden" id="hfCurrentPageIndex" name="currentPage" />
    <input type="hidden" id="hfMaxRows" name="maxRows" />
</form>

<script type="text/javascript">
    function PagerClick(index) {
        document.getElementById("hfCurrentPageIndex").value = index;
        document.getElementById("hfMaxRows").value = 2;
        document.forms[0].submit();
    }
</script>
